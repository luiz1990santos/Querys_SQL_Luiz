select distinct DATE(DATA_ENVIO_SMS), COUNT(*) FROM `eai-datalake-data-sandbox.analytics_prevencao_fraude.Tabela_Unico_SMS_BIO_Telefone`
-- where date(DATA_ENVIO_SMS) >= '2024-03-'   '2024-05-04'
group by 1
order by 1 desc
;

UPDATE `eai-datalake-data-sandbox.analytics_prevencao_fraude.Tabela_Unico_SMS_BIO_Telefone`
SET DATA_ENVIO_SMS = 
    CASE 
        WHEN DATE(DATA_ENVIO_SMS) = '2024-12-04' THEN  TIMESTAMP(CONCAT('2024-04-12', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-11-04' THEN  TIMESTAMP(CONCAT('2024-04-11', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-10-04' THEN  TIMESTAMP(CONCAT('2024-04-10', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-09-04' THEN  TIMESTAMP(CONCAT('2024-04-09', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-08-04' THEN  TIMESTAMP(CONCAT('2024-04-08', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-07-04' THEN  TIMESTAMP(CONCAT('2024-04-07', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-06-04' THEN  TIMESTAMP(CONCAT('2024-04-06', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-06-04' THEN  TIMESTAMP(CONCAT('2024-04-06', ' ',TIME(DATA_ENVIO_SMS)))
        ELSE TIMESTAMP(DATA_ENVIO_SMS)
    END
WHERE DATE(DATA_ENVIO_SMS) >= '2024-04-09';

UPDATE `eai-datalake-data-sandbox.analytics_prevencao_fraude.Tabela_Unico_SMS_BIO_Telefone_Hist`
SET DATA_ENVIO_SMS = 
    CASE 
        WHEN DATE(DATA_ENVIO_SMS) = '2024-12-04' THEN  TIMESTAMP(CONCAT('2024-03-12', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-11-03' THEN  TIMESTAMP(CONCAT('2024-03-11', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-10-03' THEN  TIMESTAMP(CONCAT('2024-03-10', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-09-03' THEN  TIMESTAMP(CONCAT('2024-03-09', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-08-03' THEN  TIMESTAMP(CONCAT('2024-03-08', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-07-03' THEN  TIMESTAMP(CONCAT('2024-03-07', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-06-03' THEN  TIMESTAMP(CONCAT('2024-03-06', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-05-03' THEN  TIMESTAMP(CONCAT('2024-03-05', ' ',TIME(DATA_ENVIO_SMS)))
        WHEN DATE(DATA_ENVIO_SMS) = '2024-04-03' THEN  TIMESTAMP(CONCAT('2024-03-04', ' ',TIME(DATA_ENVIO_SMS)))
        ELSE TIMESTAMP(DATA_ENVIO_SMS)
    END
WHERE DATE(DATA_ENVIO_SMS) >= '2024-03-04';







UPDATE `eai-datalake-data-sandbox.analytics_prevencao_fraude.Tb_Base_Token_Bio`
SET DATA = 
    CASE 
        WHEN DATE(DATA) = '2024-12-04' THEN  TIMESTAMP(CONCAT('2024-04-12', ' ',TIME(DATA)))
        WHEN DATE(DATA) = '2024-11-04' THEN  TIMESTAMP(CONCAT('2024-04-11', ' ',TIME(DATA)))
        WHEN DATE(DATA) = '2024-10-04' THEN  TIMESTAMP(CONCAT('2024-04-10', ' ',TIME(DATA)))
        WHEN DATE(DATA) = '2024-09-04' THEN  TIMESTAMP(CONCAT('2024-04-09', ' ',TIME(DATA)))
        WHEN DATE(DATA) = '2024-08-04' THEN  TIMESTAMP(CONCAT('2024-04-08', ' ',TIME(DATA)))
        WHEN DATE(DATA) = '2024-07-04' THEN  TIMESTAMP(CONCAT('2024-04-07', ' ',TIME(DATA)))
        WHEN DATE(DATA) = '2024-06-04' THEN  TIMESTAMP(CONCAT('2024-04-06', ' ',TIME(DATA)))
        WHEN DATE(DATA) = '2024-05-04' THEN  TIMESTAMP(CONCAT('2024-04-05', ' ',TIME(DATA)))
        ELSE TIMESTAMP(DATA)
    END
WHERE DATE(DATA) >= '2024-04-09';






